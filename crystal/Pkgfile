# Description: The Crystal Programming Language.
# URL:         http://crystal-lang.org/
# Packager:    Luiz de Milon, kori at openmailbox.org
# Maintainer:  6c37 Team, https://github.com/6c37/crux-ports/issues
# Depends on:  boehm-gc gmp libpcl libpcre libunwind libxml2 libyaml

name=crystal
version=git
release=1
source=(https://github.com/manastech/crystal/releases/download/0.7.6/crystal-0.7.6-1-linux-x86_64.tar.gz)

build() {
	cd $PKGMK_SOURCE_DIR

	if cd $name; then
		git fetch -q; git reset --hard origin/master
	else
		git clone https://github.com/manastech/crystal/ -b master $name
		cd $name
	fi


	make release=1 PATH="$PATH:$SRC/bin" CRYSTAL_CONFIG_PATH="libs:/usr/lib/crystal"

	install -Dm755 .build/crystal $PKG/usr/bin/crystal
	install -d $PKG/usr/lib
	cp -R src $PKG/usr/lib/crystal
}
