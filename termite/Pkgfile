# Description: A keyboard-centric VTE-based terminal.
# URL:         https://github.com/thestinger/termite
# Maintainer:  6c37 Team, https://github.com/6c37/crux-ports-git/issues
# Depends on:  git vte3

name=termite
version=git
release=2
source=(fix-transparency.patch)

build() {
	cd $PKGMK_SOURCE_DIR

	if cd $name; then
		git fetch -q; git reset --hard origin/master
	else
		git clone --recursive git://github.com/thestinger/$name $name
		cd $name
	fi

	sed -i 's|vte_terminal_set_color_cursor_foreground|vte_terminal_set_color_foreground|' termite.cc

	patch -Np1 < $SRC/fix-transparency.patch

	make PREFIX=/usr
	tic -x termite.terminfo -o terminfo
	install -Dm644 man/termite.1 $PKG/usr/share/man/man1/termite.1
	install -Dm644 man/termite.config.5 $PKG/usr/share/man/man5/termite.config.5
	install -Dm644 terminfo/x/xterm-termite $PKG/usr/share/terminfo/x/xterm-termite
	install -Dm755 termite $PKG/usr/bin/termite
}
